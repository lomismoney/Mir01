# Docker éƒ¨ç½²æª”æ¡ˆçµæ§‹èªªæ˜

æœ¬æ–‡æª”èªªæ˜å°ˆæ¡ˆä¸­ Docker éƒ¨ç½²ç›¸é—œçš„æª”æ¡ˆçµæ§‹å’Œç”¨é€”ã€‚

## ğŸ“ æª”æ¡ˆçµæ§‹

```
Mir01/
â”œâ”€â”€ docker-compose.yml           # Docker Compose é…ç½®
â”œâ”€â”€ docker-env-example          # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ deploy.sh                   # éƒ¨ç½²è¼”åŠ©è…³æœ¬
â”œâ”€â”€ Dockeréƒ¨ç½²æŒ‡å—.md           # è©³ç´°éƒ¨ç½²æŒ‡å—
â”‚
â”œâ”€â”€ inventory-api/              # å¾Œç«¯ API
â”‚   â”œâ”€â”€ Dockerfile             # å¾Œç«¯ Docker æ˜ åƒé…ç½®
â”‚   â”œâ”€â”€ .dockerignore          # Docker æ§‹å»ºå¿½ç•¥è¦å‰‡
â”‚   â”œâ”€â”€ env.example            # å¾Œç«¯ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”‚   â””â”€â”€ docker/                # Docker ç›¸é—œé…ç½®
â”‚       â”œâ”€â”€ nginx/
â”‚       â”‚   â””â”€â”€ default.conf   # Nginx é…ç½®
â”‚       â”œâ”€â”€ supervisor/
â”‚       â”‚   â””â”€â”€ supervisord.conf # Supervisor é…ç½®
â”‚       â””â”€â”€ entrypoint.sh      # å®¹å™¨å•Ÿå‹•è…³æœ¬
â”‚
â””â”€â”€ inventory-client/           # å‰ç«¯æ‡‰ç”¨
    â”œâ”€â”€ Dockerfile             # å‰ç«¯ Docker æ˜ åƒé…ç½®
    â”œâ”€â”€ .dockerignore          # Docker æ§‹å»ºå¿½ç•¥è¦å‰‡
    â””â”€â”€ env.example            # å‰ç«¯ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. æº–å‚™ç’°å¢ƒè®Šæ•¸
```bash
cp docker-env-example .env
# ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥å¯¦éš›é…ç½®
```

### 2. åˆå§‹åŒ–éƒ¨ç½²ï¼ˆç¬¬ä¸€æ¬¡ï¼‰
```bash
./deploy.sh init
```

### 3. æ›´æ–°éƒ¨ç½²
```bash
./deploy.sh update
```

## ğŸ”§ ä¸»è¦é…ç½®æª”æ¡ˆèªªæ˜

### docker-compose.yml
- å®šç¾©æ‰€æœ‰æœå‹™ï¼ˆMySQLã€Redisã€APIã€Frontendã€phpMyAdminï¼‰
- è¨­å®šæœå‹™é–“çš„ç¶²è·¯é€£æ¥
- ç®¡ç†è³‡æ–™å·æŒä¹…åŒ–
- é…ç½®å¥åº·æª¢æŸ¥

### Dockerfileï¼ˆå‰ç«¯ï¼‰
- ä½¿ç”¨å¤šéšæ®µæ§‹å»ºå„ªåŒ–æ˜ åƒå¤§å°
- åŸºæ–¼ Node.js 20 Alpine
- å•Ÿç”¨ Next.js standalone æ¨¡å¼
- ä½¿ç”¨é root ç”¨æˆ¶é‹è¡Œ

### Dockerfileï¼ˆå¾Œç«¯ï¼‰
- åŸºæ–¼ PHP 8.2-FPM
- æ•´åˆ Nginx å’Œ Supervisor
- åŒ…å«æ‰€æœ‰å¿…è¦çš„ PHP æ“´å±•
- è‡ªå‹•åŸ·è¡Œ Laravel å„ªåŒ–

### deploy.sh
æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š
- `init` - åˆå§‹åŒ–éƒ¨ç½²
- `up` - å•Ÿå‹•æœå‹™
- `down` - åœæ­¢æœå‹™
- `logs` - æŸ¥çœ‹æ—¥èªŒ
- `backup` - å‚™ä»½è³‡æ–™åº«
- `restore` - æ¢å¾©è³‡æ–™åº«
- `update` - æ›´æ–°éƒ¨ç½²
- `status` - æª¢æŸ¥ç‹€æ…‹

## ğŸŒ åŸŸåé…ç½®

### ç”Ÿç”¢ç’°å¢ƒ
- å‰ç«¯ï¼šhttps://los.lomis.com.tw
- å¾Œç«¯ï¼šhttps://api.lomis.com.tw

### æœ¬åœ°é–‹ç™¼
- å‰ç«¯ï¼šhttp://localhost:3000
- å¾Œç«¯ï¼šhttp://localhost:8080
- phpMyAdminï¼šhttp://localhost:8888ï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é …

1. **ç’°å¢ƒè®Šæ•¸**
   - æ°¸é ä¸è¦å°‡ .env æª”æ¡ˆæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
   - ä½¿ç”¨å¼·å¯†ç¢¼
   - å®šæœŸæ›´æ–°å¯†é‘°

2. **ç¶²è·¯å®‰å…¨**
   - ä½¿ç”¨ HTTPSï¼ˆSSL/TLSï¼‰
   - é…ç½®é©ç•¶çš„ CORS ç­–ç•¥
   - é™åˆ¶è³‡æ–™åº«ç«¯å£è¨ªå•

3. **å®¹å™¨å®‰å…¨**
   - ä½¿ç”¨é root ç”¨æˆ¶é‹è¡Œæ‡‰ç”¨
   - å®šæœŸæ›´æ–°åŸºç¤æ˜ åƒ
   - æœ€å°åŒ–æ˜ åƒå¤§å°

## ğŸ“Š ç›£æ§å’Œç¶­è­·

### æŸ¥çœ‹æ—¥èªŒ
```bash
# æ‰€æœ‰æœå‹™
./deploy.sh logs

# ç‰¹å®šæœå‹™
./deploy.sh logs api
./deploy.sh logs frontend
```

### å‚™ä»½è³‡æ–™åº«
```bash
./deploy.sh backup
```

### æ¸…ç†è³‡æº
```bash
# æ¸…ç†æœªä½¿ç”¨çš„æ˜ åƒ
docker image prune -a

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨è³‡æº
docker system prune -a
```

## ğŸ› å¸¸è¦‹å•é¡Œ

### 1. ç«¯å£è¡çª
å¦‚æœç«¯å£å·²è¢«ä½”ç”¨ï¼Œä¿®æ”¹ .env æª”æ¡ˆä¸­çš„ç«¯å£è¨­å®šï¼š
```env
API_PORT=8081
FRONTEND_PORT=3001
```

### 2. æ¬Šé™å•é¡Œ
ç¢ºä¿ storage ç›®éŒ„æœ‰æ­£ç¢ºçš„æ¬Šé™ï¼š
```bash
docker-compose exec api chown -R www-data:www-data storage bootstrap/cache
```

### 3. è³‡æ–™åº«é€£æ¥å¤±æ•—
æª¢æŸ¥ MySQL å®¹å™¨æ˜¯å¦æ­£å¸¸é‹è¡Œï¼š
```bash
docker-compose ps mysql
docker-compose logs mysql
```

## ğŸ“š ç›¸é—œæ–‡æª”

- [Dockeréƒ¨ç½²æŒ‡å—.md](Dockeréƒ¨ç½²æŒ‡å—.md) - è©³ç´°éƒ¨ç½²æ­¥é©Ÿ
- [éƒ¨ç½²æŒ‡å—.md](éƒ¨ç½²æŒ‡å—.md) - ç¸½é«”éƒ¨ç½²æ¦‚è¦½
- [README.md](README.md) - å°ˆæ¡ˆèªªæ˜

---

æœ€å¾Œæ›´æ–°ï¼š2024å¹´12æœˆ 